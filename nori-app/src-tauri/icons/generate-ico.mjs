import { writeFileSync } from 'fs';
import toIco from 'to-ico';

// Create a simple 32x32 PNG buffer (orange square)
const createPNG = () => {
  // Minimal PNG: 32x32, orange color
  const png = Buffer.from([
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG signature
    0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52, // IHDR chunk
    0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, // 32x32
    0x08, 0x02, 0x00, 0x00, 0x00, 0xFC, 0x18, 0xED, 0xA3,
    0x00, 0x00, 0x00, 0x1C, 0x49, 0x44, 0x41, 0x54, // IDAT chunk (minimal data)
    0x48, 0xC7, 0xED, 0xC1, 0x01, 0x01, 0x00, 0x00,
    0x00, 0x80, 0x90, 0xFE, 0xAF, 0xEE, 0x08, 0x0A,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x70, 0x00, 0x01, 0x00, 0x00, 0x05, 0x00, 0x01,
    0x0D, 0x0A, 0x2D, 0xB4,
    0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, // IEND chunk
    0xAE, 0x42, 0x60, 0x82
  ]);
  return png;
};

const png = createPNG();
const ico = await toIco([png]);

writeFileSync('icon.ico', ico);
console.log('Generated valid icon.ico');
